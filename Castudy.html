<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="Castudy.css">
</head>
<body onkeydown="keydownHandler()">
    <div>
        <img src="https://scr.vn/wp-content/uploads/2020/07/%E1%BA%A3nh-n%E1%BB%81n-t%E1%BB%91i-gi%E1%BA%A3n-ch%C3%BA-m%C3%A8o-%C4%91en-2048x1280.png" alt="Khong hien thi">
        <button id="start" onclick="start()">Start</button>
        <button id="stop" onclick="stop()">Stop</button>
        <button id="reset" onclick="reset()">Reset</button>
        <canvas  width="800" height="700" id="canvas"  ></canvas>
    </div>

</body>
<script >
    
    let canvas = document.getElementById("canvas")
    let ctx = canvas.getContext("2d")
    
    
    
    class Circle {
        x
        y
        radius
        color
        constructor(x, y, radius, color) {
            this.x = x
            this.y = y
            this.radius = radius
            this.color = color
        }
        
        // setX(x){
        //     this.x = x
        // }
        // setY(y){
        //       this.y = y
        // }
        
        
        drawCircle() {
            ctx.beginPath()
            ctx.fillStyle = this.color
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2)
            ctx.fill()
            ctx.closePath()
        }
    }
    
    
    
    class Paddle{
        x
        width
        height
        color
        constructor(x,y,width,height,color) {
            this.x = x
            this.y = y
            this.width = width
            this.height = height
            this.color =color
        }
        
        
        drawPaddle(){
            ctx.beginPath()
            ctx.fillStyle= this.color
            ctx.fillRect(this.x,this.y,this.width,this.height)
            ctx.stroke()
            ctx.closePath()
        }
        
    }
    
    
    let circle1 = new Circle(canvas.offsetWidth/3, 400, 15,"#2280ff")
    let paddle1 = new Paddle(canvas.offsetWidth/4,canvas.offsetHeight-8,canvas.offsetWidth,10,"black")
    
    
    // function moveRight(){
    //     if (paddle1.x<canvas.offsetWidth-paddle1.width){
    //         paddle1.x+=40
    //     }
    // }
    //
    // function moveLeft(){
    //     if (paddle1.x>0){
    //         paddle1.x-=40
    //     }
    // }
    
    
    let score = 0
    function drawScore(){
        ctx.font = "20px Arial"
        ctx.fillStyle = "blue"
        ctx.fillText("Score: "+score, 5, 20)
    }
    
    
    function keydownHandler(){
        if(event.key === "ArrowRight" && paddle1.x<canvas.offsetWidth - paddle1.width){
            paddle1.x+=60
        }
        if (event.key === "ArrowLeft" && paddle1.x > 0){
            paddle1.x-=60
        }
    }
    
    
    
    let dx=1.5
    let dy=1
    function speed(){
        circle1.x += dx
        circle1.y += -dy
    }
    
    
    
    function draw() {
        ctx.clearRect(0, 0, canvas.offsetWidth, canvas.offsetHeight);
        circle1.drawCircle()
        paddle1.drawPaddle()
        drawScore()
        speed()
        
        if (circle1.x - circle1.radius <=0 || circle1.radius + circle1.x >= canvas.offsetWidth){
            dx = -dx
        }
        else if (circle1.y - circle1.radius <= 0){
            dy = -dy
            score ++
            if (score === 1){
                dx = -1.5
                dy = -1
                circle1.color = circle1.color = "#ffbf90"
            }
            else if (score === 3){
                paddle1.width -= 100
            }
            else if (score === 5){
                dx = -2.5
                dy = -1.5
                circle1.color = circle1.color = "#ff7a24"
            }
            else if (score === 7){
                paddle1.width -= 100
            }
            else if (score === 10){
                dx = -4
                dy = -2.5
                circle1.color = circle1.color = "#ff3030"
            }
        }
        else if(circle1.y + circle1.radius >= canvas.offsetHeight){
            
            
            if(circle1.x  > paddle1.x && circle1.x < paddle1.x + paddle1.width){
                dy = -dy
                
            }
            else {
                alert("Thua r :v")
                stop()
                document.location.reload();
            }
        }
        
    }
    draw()
    
    
    
    let interval
    function start() {
        draw()
        interval = setInterval(draw, 0)
    }
    
    
    function stop() {
        clearInterval(interval)
        
    }
    
    function reset(){
        document.location.reload()
    }


</script>

</html>